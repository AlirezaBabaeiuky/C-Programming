/******************************************************************************

Welcome to GDB Online.
GDB online is an online compiler and debugger tool for C, C++, Python, Java, PHP, Ruby, Perl,
C#, OCaml, VB, Swift, Pascal, Fortran, Haskell, Objective-C, Assembly, HTML, CSS, JS, SQLite, Prolog.
Code, Compile, Run and Debug online from anywhere in world.

*******************************************************************************/
#include <stdio.h>

int main()
{
    float m, c, k;
    m=1;
    c=0.1;
    k=100; 
    int kp, ki, kd;
    kp = 150;
    ki = 100;
    kd = 1;
    int ref = 1; 
    float resp = 0;
    float dt = 0.1;
    float intg = 0;
    float e = 0;
    float e_prev = 0;
    float vel = 0;
    float pos = 0; 
    for (int i=0; i<100; i++) { 
        e = ref - resp; 
        intg = intg + e*dt; 
        float der = (e-e_prev)/dt;
        float ctrl = kp*e + ki*intg + kd*der;
        float acc = (ctrl - k*resp - c*vel)/m;
        vel = vel + acc*dt;
        pos = pos + vel*dt;
        resp = pos;
        e_prev = e;
        printf("e: %f, resp: %f; ref:%d\n", e, resp, ref);
    }

    return 0;
}
